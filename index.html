<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MD MOVERS â€“ TRIP CALCULATOR</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script type="module">

/* â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Firebase Setup â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAg2WhxP6f0qr0P5-p6VOvm4_n8CTKchBg",
  authDomain: "md-movers-fleet.firebaseapp.com",
  projectId: "md-movers-fleet",
  storageBucket: "md-movers-fleet.firebasestorage.app",
  messagingSenderId: "386416808558",
  appId: "1:386416808558:web:8101db7f34a55848148c7f",
  measurementId: "G-Y0ENN2HPTL"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ROUTE MASTER -- Editable & Expandable â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ */

const routes = [
  { from:"Hazira", to:"Taloja", loadKM:350, emptyKM:100, adv:21000 },
  { from:"Hazira", to:"Kalamboli", loadKM:350, emptyKM:100, adv:21000 },
  { from:"Hazira", to:"Panvel", loadKM:350, emptyKM:100, adv:21000 },
  { from:"Hazira", to:"Thane", loadKM:350, emptyKM:100, adv:21000 },
  { from:"Hazira", to:"Khopoli", loadKM:370, emptyKM:50, adv:21400 },
  { from:"Hazira", to:"Khalapur", loadKM:370, emptyKM:50, adv:21400 },
  { from:"Hazira", to:"Ahemdabad", loadKM:300, emptyKM:0, adv:15080 },
  { from:"Hazira", to:"Bavla", loadKM:300, emptyKM:0, adv:15080 },
  { from:"Hazira", to:"Vatva", loadKM:300, emptyKM:0, adv:15080 },
  { from:"Hazira", to:"Changodar", loadKM:300, emptyKM:0, adv:15080 },
  { from:"Hazira", to:"Khatrej", loadKM:330, emptyKM:0, adv:16430 },
  { from:"Hazira", to:"Sanand", loadKM:330, emptyKM:0, adv:16430 },
  { from:"Hazira", to:"Kalol", loadKM:330, emptyKM:0, adv:16430 },
  { from:"Hazira", to:"Chhatral", loadKM:330, emptyKM:0, adv:16430 },
  { from:"Hazira", to:"Gandhinagar", loadKM:330, emptyKM:0, adv:16430 },
  { from:"Hazira", to:"Mehsana", loadKM:380, emptyKM:0, adv:18500 },
  { from:"Hazira", to:"Vithalapur", loadKM:410, emptyKM:210, adv:19400 },
  { from:"Hazira", to:"Vadodara", loadKM:210, emptyKM:0, adv:15780 },
  { from:"Hazira", to:"Savli", loadKM:210, emptyKM:0, adv:15780 },
  { from:"Hazira", to:"Por", loadKM:210, emptyKM:0, adv:15780 },
  { from:"Hazira", to:"Kheda", loadKM:280, emptyKM:0, adv:13770 },
  { from:"Hazira", to:"Halol", loadKM:230, emptyKM:230, adv:16830 },
  { from:"Hazira", to:"Vadindar", loadKM:625, emptyKM:0, adv:30300 }
];

/* â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ On Select Auto-Fill â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ */

function routeChange(){
  let f=document.getElementById("from").value;
  let t=document.getElementById("to").value;
  let r=routes.find(v=>v.from===f && v.to===t);

  if(r){
     document.getElementById("loadKM").value=r.loadKM;
     document.getElementById("emptyKM").value=r.emptyKM;
     document.getElementById("advance").innerText="â‚¹ "+r.adv;
  }
}

/* â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ CALCULATE â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ */

async function calculate(){
  let qty=+qtyInp.value;
  let rate=+rateInp.value;
  let mamul=+mamulInp.value;
  let comm=+commInp.value;
  let load=+loadKM.value;
  let empty=+emptyKM.value;

  let loadAvg=+loadAvgInp.value;
  let emptyAvg=+emptyAvgInp.value;
  let dieselPrice=+dieselRate.value;

  let freight=qty*rate;
  let commission = freight*(comm/100);
  let dieselUsed = (load/loadAvg)+(empty/emptyAvg);
  let dieselCost = dieselUsed*dieselPrice;

  let net = freight - commission - mamul - dieselCost;

  result.innerHTML = `
      Freight: â‚¹${freight} <br>
      Diesel Used: ${dieselUsed.toFixed(2)} L <br>
      Diesel Cost: â‚¹${dieselCost.toFixed(0)} <br>
      Commission: â‚¹${commission.toFixed(0)} <br>
      Mamul: â‚¹${mamul} <br>
      <b>Net Saving: â‚¹${net.toFixed(0)}</b>
  `;

  await addDoc(collection(db,"trip-records"),{
    from:from.value,to:to.value,load,empty,qty,rate,
    dieselUsed,dieselCost,commission,mamul,net,
    time:new Date()
  });

  alert("Trip Saved Successfully! ðŸš›ðŸ’¨");
}

window.calculate=calculate;
window.routeChange=routeChange;

</script>
</head>

<body class="bg-gray-100 p-6">

<h1 class="text-center text-3xl font-bold mb-6">ðŸš› MD MOVERS TRIP CALCULATOR</h1>

<div class="grid grid-cols-2 gap-3 p-4 bg-white rounded shadow max-w-3xl mx-auto">

<select id="from" onchange="routeChange()" class="border p-2"><option>Hazira</option></select>
<select id="to" onchange="routeChange()" class="border p-2">
${routes.map(r=>`<option value="${r.to}">${r.to}</option>`).join("")}
</select>

<input id="loadKM" class="border p-2" placeholder="Load KM">
<input id="emptyKM" class="border p-2" placeholder="Empty KM">

<input id="qtyInp" class="border p-2" placeholder="Qty (MT)">
<input id="rateInp" class="border p-2" placeholder="Rate â‚¹">

<input id="commInp" class="border p-2" placeholder="Commission %">
<input id="mamulInp" class="border p-2" placeholder="Mamul â‚¹">

<input id="loadAvgInp" value="2.1" class="border p-2" placeholder="Load Avg">
<input id="emptyAvgInp" value="4" class="border p-2" placeholder="Empty Avg">

<input id="dieselRate" value="92" class="border p-2" placeholder="Diesel Rate">

<button onclick="calculate()" class="col-span-2 bg-black text-white py-3 rounded">CALCULATE & SAVE</button>
</div>

<div id="result" class="mt-4 p-4 bg-white shadow text-lg font-semibold"></div>

</body>
</html>
